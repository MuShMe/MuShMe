{% extends "userprofile/layout.html" %}
{% block content %}
{%for u in User%}
<div class="container main-body">
	<div class="col-xs-3 sector-1">
		<div class="col-xs-12">
		<div class="profilepic-area" >
			<a class="profilepic-large" href="#"><img class="img-rounded profilepic-large" src="{{url_for('static',filename='img/profile.png')}}"></a>
		</div>
		<!-- Upload Profile Pic -->
			{% if u['userid'] == session['userid'] %}
			<a  class="btn btn-default middle1" onclick="launch_modal('uploadpic');">Edit</a>
			
			<div class="modal fade bs-example-modal-lg" id="uploadpic" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
				<div class="modal-dialog modal-lg">
					<div class="modal-content edit-modal">
						<form role="form" class="center" method='post' name="editForm" action="{{ url_for('editName', userid=session['userid']) }}" enctype="multipart/form-data">
							<div class="form-group spacing">
								{{ form3.name(placeholder='Name',class_='form-control') }}
							</div>
							<div class="form-group spacing">
								{{ form3.dob(placeholder='Date Of Birth',class_='form-control') }}
							</div>

							<!--<div class="form-group">
								<input type="file" id="album-art">
								<p class="help-block">Upload picture</p>
							</div>-->
							<div class="modal-footer">
							<input href="{{ url_for('userProfile', userid=session['userid']) }}" type="submit" class="btn btn-default" data-dismiss="modal" value='Close'>
							<input class="btn btn-primary" type='submit' name='btn' value='Save Changes' method="POST">
						</div>
						</form>
						

					</div>
				</div>
			</div>
			{%endif%}
	</div>
		<div class="col-xs-12">
			<h1>Friends: </h1>
			<table class="table table-hover">
				<thead>
					<th></th>
					<th></th>
				</thead>
				<tbody>
					{% for f in friend %}
					<tr><a href="#"><img class="img-circle profilepic-small playlists" src="{{url_for('static',filename='img/profile.png')}}"></a></tr>
					<tr><a href="{{ url_for('userProfile', userid=f['friendid']) }}"><h3><b> {{ f['friendname'] }}</b></h3></a></tr>
					
					{% endfor %}

					{% if friend[0] == NULL and u['userid'] == session['userid'] %}
					<tr><a href="{{ url_for('search') }}"><h3><b>Search friends to add them</b></h3></a></tr>
					{% endif %}
					
				</tbody>
			</table>
			{% if u['userid'] != session['userid'] %}
						<form action="{{ url_for('sendrequest',uidto=u['userid'],uidfrom=session['userid']) }}" method="POST">
							<input class="btn btn-primary" type='submit' name='btn' value='Send Friend Request'>
						</form>
					{% endif %}
			<!-- Apply some logic to check if the user is already a friend and then show this button -->
				

    <!-- Modal for the pending Request -->
    {% if u['userid'] == session['userid'] %}
                            <a href="javascript:void(null);" class="btn btn-primary button-center spacing" onload="launch_modal('pending_req');" onclick="launch_modal('pending_req');">Pending Request(s)</a>
                            <div class="modal fade bs-example-modal-lg" id="pending_req" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
                                    <div class="modal-dialog modal-lg">
                                            <div class="modal-content edit-modal">
                                                    <div class="middle">
                                                            <table>
                                                                    <thead>
                                                                            <tr>
                                                                                    <td></td>
                                                                                    <td></td>
                                                                                    <td></td>
                                                                                    <td></td>
                                                                            </tr>
                                                                    </thead>
                                                                    {% for req in Requests %}
                                                                    {% if req['reqto']==u['userid'] and req['status']==1 %}
                                                                    <tbody>
                                                                            <div class="space">
                                                                            	{% for requ in req['reqfromuser'] %}
                                                                                    <tr>	
                                                                                            <td><a href="#"><img class="img-circle profilepic-small playlists" src="../img/profile.png"></a></td>
                                                                                            <td><a href="{{ url_for('userProfile', userid=req['userto']) }}">{{ requ['username'] }}</a></td>
                                                                                            <form action="{{url_for('acceptrequest',userto=req['reqto'],userfrom=req['reqfrom'])}}" method='POST'>
                                                                                            	<td><input class="btn btn-success button-center" type='submit' name='btn' value='Accept' method="POST"></td>
                                                                                        	</form>
                                                                                            <form action="{{url_for('rejectrequest',userto=req['reqto'],userfrom=req['reqfrom'])}}" method='POST'>
                                                                                            	<td><input class="btn btn-danger button-center" type='submit' name='btn' value='Reject' method="POST"></td>
                                                                                        	</form>
                                                                                    </tr>
                                                                                {% endfor %}
                                                                            </div>
                                                                            
                                                                    </tbody>
                                                                    {% endif %}
                                                                    {% endfor %}
                                                            </table>
                                                            <div class="modal-footer">
                                                                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                                            </div>
                                                    </div>
                                            </div>
                                    </div>
                            </div>

            {%endif%}
		</div>
	</div>
	<div class="col-xs-6 sector-2">
		<div class="About-us">
			<h2 class="text-center"> About : </h2>
			<dl class="dl-horizontal">
				<dt> <h3> <b>Username:</b></h3></dt>
				<dd> <h3>{{u['username']}}</h3></dd>
				<dt> <h3> <b>Name:</b></h3></dt>
				<dd><h3>{{ u['name'] }}</h3></dd> 
				<dt> <h3> <b>Date of Birth:</b></h3></dt>
				<dd><h3>{{ u['dob'] }}</h3></dd>
			</dl>
			<!-- Edit modal -->
			{% if u['userid'] == session['userid'] %}
			<a  class="btn btn-default submit" onclick="launch_modal('useredit');">Edit</a>
			
			<div class="modal fade bs-example-modal-lg" id="useredit" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
				<div class="modal-dialog modal-lg">
					<div class="modal-content edit-modal">
						<form role="form" class="center" method='post' name="editForm" action="{{ url_for('editName', userid=session['userid']) }}" enctype="multipart/form-data">
							<div class="form-group spacing">
								{{ form3.name(placeholder='Name',class_='form-control') }}
							</div>
							<div class="form-group spacing">
								{{ form3.dob(placeholder='Date Of Birth',class_='form-control') }}
							</div>

							<!--<div class="form-group">
								<input type="file" id="album-art">
								<p class="help-block">Upload picture</p>
							</div>-->
							<div class="modal-footer">
							<input href="{{ url_for('userProfile', userid=session['userid']) }}" type="submit" class="btn btn-default" data-dismiss="modal" value='Close'>
							<input class="btn btn-primary" type='submit' name='btn' value='Save Changes' method="POST">
						</div>
						</form>
						

					</div>
				</div>
			</div>
			{% endif %}


		</div>
		<div class="comm-recom">
			<form method="POST" action="{{ url_for('comment', rcvrid=userid, senderid=session['userid']) }}" >
				{{ form4.hidden_tag() }}
				{{ form4.comment(placeholder="Write Something....", class_="form-control",rows=4) }}
				<input class="btn btn-default submit" type='submit' name='btn' value='Submit'>
			</form>
			
		</div>
		<div class="comments">
			{% for c in Comments %}
			<blockquote>
				<p>{{ c['comment'] }}</p>
				<footer><a href="{{url_for('userProfile', userid=c['userid'])}}"><cite title="Username">{{ c['username'] }}</cite></a></footer>
				<!-- Report Add modal -->
				<a href="javascript:void(null);" class="btn btn-danger submit" onclick="launch_modal('report');">Report</a>
				<div class="modal fade bs-example-modal-lg" id="report" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
					<div class="modal-dialog modal-lg">
						<div class="modal-content edit-modal">
							<form role="form" class="center" action="{{ url_for('report',commentid=c['commentid'], userid=c['userid']) }}" method='POST'>
								<div class="radio">
									<label>
										{{ form5.report() }}
									</label>
									</div>
										{{ form5.other(class="form-control", rows="4", placeholder="Write some description for your Complaint..") }}
										<div class="modal-footer">
								<input href="{{ url_for('userProfile', userid=session['userid']) }}" type="submit" class="btn btn-default" data-dismiss="modal" value='Close'>
								<input href="{{ url_for('userProfile', userid=session['userid']) }}" class="btn btn-primary" type='submit' name='btn' value='Submit' method="POST">
							</div>
							</form>
							

						</div>
					</div>
				</div>
			</blockquote>
			{% endfor %}
			{% for r in Recommends %}
			{% if r['userto']==session['userid'] %}
			<blockquote>
				<header><a href="{{ url_for('userProfile', userid=r['userto']) }}"><cite title="Username">{{r['userfrom']}}</cite></a> Recommends :</header>
				<table class="table table-hover">
					<thead>
						<tr>
						<th></th>
						<th></th>
						<th></th>
						</tr>
					</thead>
					{%for song in r['song']%}
					<tbody>
						<tr>
						<td><a href="#"><img class="img-circle profilepic-small playlists" src="../img/albumart.jpg"></a></td>
						<td><a href="#"><h4><b>{{ song['title'] }} - {{song['album'] }}, {{song['genre']}}, {{song['publisher']}}</b></h4></a></td>
						</tr>
					</tbody>
					{% endfor %}
					{%for p in r['playlist']%}
					<tbody>
						<tr>
						<td><a href="#"><img class="img-circle profilepic-small playlists" src="../img/albumart.jpg"></a></td>
						<td><a href="#"><h4><b>{{ p['pname'] }} - {{p['username']}}, {{p['uname']}}  </b></h4></a></td>
						</tr>
					</tbody>
					{% endfor %}
				</table>
			</blockquote>
		
			{% else %}
				<table class="table table-hover">
							<thead>
								<tr>
								<th></th>
								<th></th>
								<th></th>
								</tr>
							</thead>
							<tbody>
								<tr>
								<td><h4><b>No recommendations yet ! </b></h4></td>
								</tr>
							</tbody>
			{%endif%}
			{%endfor%}
		</div>
	</div>
	<div class="col-xs-3 sector-3">
		<div class="playlist-section">
			<h2>Playlists:</h2>
			<table class="table table-hover">
				<thead>
					<th></th>
					<th></th>
				</thead>
				<tbody>
					{% for p in playlist %}
					<tr><a href="#"><img class="img-circle profilepic-small playlists" src="{{url_for('static',filename='img/albumart.jpg')}}"></a></tr>
					<tr><a href="#"><h3><b>{{ p['pname'] }}</b></h3></a></tr>
					{% endfor %}
					
				</tbody>
			</table>
			<!-- Playlist Add modal -->
			{% if u['userid'] == session['userid'] %}
			<a href="javascript:void(null);" class="btn btn-success" onclick="launch_modal('addplaylist');">Add New+</a>
			<div class="modal fade bs-example-modal-lg" id="addplaylist" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
				<div class="modal-dialog modal-lg">
					<div class="modal-content edit-modal">
						<form action="{{ url_for('addplaylist', userid=session['userid']) }}" role="form" class="center" method='POST' >
							<div class="form-group spacing">
								{{ form7.add(placeholder='Add Playlist..',class_='form-control') }}
							</div>
							<div class="modal-footer">
								<input href="{{ url_for('userProfile', userid=session['userid']) }}" type="submit" class="btn btn-default" data-dismiss="modal" value='Close'>
								<input class="btn btn-primary" type='submit' name='btn' value='Submit' method="POST">
							</div>
						</form>
						

					</div>
				</div>
			</div>
			{%endif%}
		</div>

		<div class="songs-section">
			<h2>Songs:</h2>
			<table class="table table-hover">
				<thead>
					<th></th>
					<th></th>
				</thead>
				<tbody>
					{% for s in song %}
					<tr><a href="#"><img class="img-circle profilepic-small playlists" src="{{ url_for('static',filename='img/albumart.jpg') }}"></a></tr>
					<tr><a href="#"><h3><b>{{ s['songname'] }}</b></h3></a></tr>
					{% endfor %}
					
				</tbody>
			</table>
			<!-- Songs Add modal -->
			{% if u['userid'] == session['userid'] %}
			<a href="javascript:void(null);" class="btn btn-success" onclick="launch_modal('addsong');">Add New+</a>
			<div class="modal fade bs-example-modal-lg" id="addsong" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
				<div class="modal-dialog modal-lg">
					<div class="modal-content edit-modal">
						<form role="form" class="center" >
							<div class="form-group">
								<input type="file" id="album-art">
								<p class="help-block">Upload Song</p>
							</div>
							<div class="modal-footer">
								<input href="{{ url_for('userProfile', userid=session['userid']) }}" type="submit" class="btn btn-default" data-dismiss="modal" value='Close'>
								<input href="{{ url_for('uploadSong', userid=session['userid']) }}" class="btn btn-primary" type='submit' name='btn' value='Submit' method="POST">
							</div>
						</form>
						

					</div>
				</div>
			</div>
			{%endif%}
		</div>
	</div>
</div>
{%endfor%}
{% endblock %}